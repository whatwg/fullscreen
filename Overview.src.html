<!doctype html>
<html lang="en-US">
 <head>
  <meta charset=UTF-8>
  <title>Fullscreen</title>
  <style>
   pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em 1em }
   pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
   pre code { color:inherit; background:transparent }
   pre.css { border: solid 0.0625em; background: #FFFFEE; color: black; padding: 0.5em 1em; }
   .example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
   .note { margin-left:2em; font-weight:bold; font-style:italic; color:#008000 }
   p.note::before { content:"Note: " }
   .XXX { padding:.5em; border:solid #f00 }
   p.XXX::before { content:"Issue: " }
   dl.switch { padding-left:2em }
   dl.switch > dt { text-indent:-1.5em }
   dl.switch > dt:before { content:'\21AA'; padding:0 0.5em 0 0; display:inline-block; width:1em; text-align:right; line-height:0.5em }
   dl.domintro { color: green; margin: 2em 0 2em 2em; padding: 0.5em 1em; border: none; background: #DDFFDD; }
   dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
   dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
   dl.domintro dd p { margin: 0.5em 0; }
   dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This box is non-normative. Implementation requirements are given below this box.'; color: red; border: solid 2px; background: white; padding: 0 0.25em; }
   em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
   dfn { font-weight:bold; font-style:normal }
   code { color:orangered }
   code :link, code :visited { color:inherit }
   hr:not(.top) { display:block; background:none; border:none; padding:0; margin:2em 0; height:auto }
   table { border-collapse:collapse; border-style:hidden hidden none hidden }
   table thead { border-bottom:solid }
   table tbody th:first-child { border-left:solid }
   table td, table th { border-left:solid; border-right:solid; border-bottom:solid thin; vertical-align:top; padding:0.2em }

   .warning { color: red; background: transparent; font-weight: bolder; font-style: italic; }
   .warning p:first-child { margin-top: 0; }
   .warning p:last-child { margin-bottom: 0; }
   .warning:before { font-style: normal; }
   p.warning:before { content: '\26A0 Warning! '; }

   @media print {
     [data-anolis-spec]::after { content:"[" attr(data-anolis-spec) "]"; font-size:.6em; vertical-align:super; text-transform:uppercase }
   }
  </style>
  <link rel=stylesheet class=dontpublish href="http://www.whatwg.org/style/specification">
  <link rel=stylesheet class=publish href="http://www.w3.org/StyleSheets/TR/W3C-[STATUS]">
 </head>
 <body>

<div class=head>
<div class=publish><!--logo--></div>
 <h1>Fullscreen</h1>
 <h2 class="no-num no-toc">Editors' Draft [DATE: 01 Jan 1901]</h2>

 <dl>
  <dt>This Version:
  <dd class=dontpublish><a href="http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html">http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html</a>
  <dd class=publish><a href="[VERSION]">[VERSION]</a>

  <dt>Participate:</dt>
  <dd><a href="http://www.whatwg.org/mailing-list">whatwg@whatwg.org</a>
  <dd><a href="http://www.w3.org/Bugs/Public/enter_bug.cgi?product=WebAppsWG&amp;component=Fullscreen">File a bug</a>
  <dd><a href="http://wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a>

  <dt class=publish>Latest Version:
  <dd class=publish><a href="[LATEST]">[LATEST]</a>

  <dt class=publish>Latest Editor Draft:
  <dd class=publish><a href="http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html">http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html</a>

  <!--
  <dt>Previous Versions:
  -->

  <dt>Editors:
  <dd class="vcard h-card"><a class="url u-url fn p-fn" lang="nl" href="http://annevankesteren.nl/">Anne van Kesteren</a>
    (<a class="org h-org" href="http://www.opera.com/">Opera Software ASA</a>)
    &lt;<a class="email u-email" href="mailto:annevk@opera.com">annevk@opera.com</a>>

  <dd class="vcard h-card"><a class="url u-url fn p-fn" lang="tr" href="http://tantek.com/">Tantek Çelik</a>
    (<a class="org h-org" href="http://www.mozilla.org/">Mozilla Foundation</a>)
    &lt;<a class="email u-email" href="mailto:tantek@cs.stanford.edu">tantek@cs.stanford.edu</a>>
 </dl>

<p class=copyright><a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/"><img src="http://i.creativecommons.org/p/zero/1.0/80x15.png" alt="CC0"></a>
To the extent possible under law, the editors have waived all copyright and
related or neighboring rights to this work. In addition, as of
[DATE: 01 Jan 1901], the editors have made this specification available
under the
<a rel="license"
href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0">Open Web Foundation Agreement Version 1.0</a>,
which is available at
http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
<!-- XXX
When published on W3C TR, the following paragraph applies as well.
-->
<!-- XXX copyright-->
</div>

<div class=publish>
<hr class=top>


<h2 class="no-num no-toc">Abstract</h2>

<p>The Fullscreen specification defines a way for an
<span data-anolis-spec=dom title=concept-element>element</span> to be
displayed fullscreen programmatically. This allows for video players or
games to be used fullscreen.</p>


<h2 class="no-num no-toc" id=sotd>Status of this Document</h2>
<p>Whatever.
</div>


<h2 class="no-num no-toc">Table of Contents</h2>
<!--toc-->



<h2>Conformance</h2>
<p>All diagrams, examples, and notes in this specification are
non-normative, as are all sections explicitly marked non-normative.
Everything else in this specification is normative.

<p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in the normative parts of this specification are to be
interpreted as described in RFC2119. For readability, these words do
not appear in all uppercase letters in this specification.
<span data-anolis-ref>RFC2119</span>



<h2>Terminology</h2>

<p>Most terminology used in this specification is from DOM and HTML.
<span data-anolis-ref>DOM</span>
<span data-anolis-ref>HTML</span>

<p>The term <dfn>context object</dfn> means the object on which the method
or attribute being discussed was called. When the
<span>context object</span> is unambiguous, the term can be omitted.

<p>A <span data-anolis-spec=html>browsing context</span> <var title>A</var>
is called a <dfn>descendant browsing context</dfn> of a
<span data-anolis-spec=html>browsing context</span> <var title>B</var> if
and only if <var title>B</var> is an
<span data-anolis-spec=html>ancestor browsing context</span> of
<var title>A</var>.



<h2>Model</h2>

<p>The <span data-anolis-spec=html>task source</span> used by this
specification is the
<span data-anolis-spec=html>user interaction task source</span>.

<p>All <span data-anolis-spec=dom title=concept-document>documents</span>
have an associated <dfn>fullscreen enabled flag</dfn> and
<dfn>fullscreen element stack</dfn>. Unless otherwise stated the
<span>fullscreen enabled flag</span> is unset and the
<span>fullscreen element stack</span> is empty.

<p class=note>HTML defines under what conditions the
<span>fullscreen enabled flag</span> is set.
<span data-anolis-ref>HTML</span>
<!--
  not set for <iframe>, createDocument();
  set for <iframe allowfullscreen>
-->

<p>To <dfn title=concept-fullscreen-push>push</dfn> an
<var title>element</var> on a <var title>document</var>'s
<span>fullscreen element stack</span>, push it on top of
<var title>document</var>'s
<span data-anolis-spec=html>browsing context</span>'s
<span>top layer</span>, and then push it on top of
<var title>document</var>'s <span>fullscreen element stack</span>.

<p>To <dfn title=concept-fullscreen-remove>remove</dfn> an
<var title>element</var> from a <var title>document</var>'s
<span>fullscreen element stack</span>, remove it from
<var title>document</var>'s
<span data-anolis-spec=html>browsing context</span>'s
<span>top layer</span>, and then remove it from
<var title>document</var>'s <span>fullscreen element stack</span>.

<p>To <dfn title=concept-fullscreen-empty>empty</dfn> a
<var title>document</var>'s <span>fullscreen element stack</span>, remove
all the <span data-anolis-spec=dom title=concept-element>elements</span> in
it from <var title>document</var>'s
<span data-anolis-spec=html>browsing context</span>'s
<span>top layer</span>, and then empty <var title>document</var>'s
<span>fullscreen element stack</span>.

<hr>

<p>To <dfn>fully exit fullscreen</dfn> act as if the
<code title=dom-Document-exitFullscreen>exitFullscreen()</code> method
was invoked on the
<span data-anolis-spec=html>top-level browsing context</span>'s
<span data-anolis-spec=dom title=concept-document>document</span> and
subsequently <span title=concept-fullscreen-empty>empty</span> that
<span data-anolis-spec=dom title=concept-document>document</span>'s
<span>fullscreen element stack</span>.

<p class=note>Since a <code title>fullscreenchange</code> event will be
dispatched regardless, emptying the <span>fullscreen element stack</span>
per above is fine.

<p>If an <span data-anolis-spec=dom title=concept-element>element</span>
at the top of a <span>fullscreen element stack</span> is removed from a
<span data-anolis-spec=dom title=concept-document>document</span>,
<span>fully exit fullscreen</span>.
<!-- XXX reference DOM mutation -->


<h2>API</h2>

<pre class=idl>partial interface <span data-anolis-spec=dom>Element</span> {
  void <span title=dom-Element-requestFullscreen>requestFullscreen</span>();
};

partial interface <span data-anolis-spec=dom>Document</span> {
  readonly attribute boolean <span title=dom-Document-fullscreenEnabled>fullscreenEnabled</span>;
  readonly attribute <span data-anolis-spec=dom>Element</span> <span title=dom-Document-fullscreenElement>fullscreenElement</span>;

  void <span title=dom-Document-exitFullscreen>exitFullscreen</span>();
};</pre>

<p>The
<dfn title=dom-Element-requestFullscreen><code>requestFullscreen()</code></dfn>
method must run these steps:

<ol>
 <li>
  <p>If any of the following conditions are true, terminate these steps and
  <span data-anolis-spec=html>queue a task</span> to
  <span data-anolis-spec=dom title=concept-event-fire>fire an event</span>
  named <code>fullscreenerror</code> with its
  <code title=dom-Event-bubbles>bubbles</code> attribute set to true on the
  <span>context object</span>'s
  <span data-anolis-spec=dom title=concept-node-document>node document</span>:

  <ul>
   <li><p>The <span>context object</span> is not
   <span data-anolis-spec=dom>in a document</span>.

   <li><p>The <span>context object</span>'s
   <span data-anolis-spec=dom title=concept-node-document>node document</span>, or an
   <span data-anolis-spec=html>ancestor browsing context</span>'s
   <span data-anolis-spec=dom title=concept-document>document</span> does
   not have the <span>fullscreen enabled flag</span> set.

   <li><p>The <span>context object</span>'s
   <span data-anolis-spec=dom title=concept-node-document>node document</span>
   <span>fullscreen element stack</span> is not empty and its top
   <span data-anolis-spec=dom title=concept-element>element</span> is not an
   <span data-anolis-spec=dom title=concept-tree-ancestor>ancestor</span> of
   the <span>context object</span>.

   <li><p>A <span>descendant browsing context</span>'s
   <span data-anolis-spec=dom title=concept-document>document</span> has a
   non-empty <span>fullscreen element stack</span>.

   <li><p>This algorithm is not
   <span data-anolis-spec=html>allowed to show a pop-up</span>.

   <li><p>There is a previously-established user preference, security risk,
   or platform limitation.
  </ul>

 <li><p>Let <var title>doc</var> be <var title>element</var>'s
 <span data-anolis-spec=dom title=concept-node-document>node document</span>.

 <li><p>Let <var title>docs</var> be all <var title>doc</var>'s
 <span data-anolis-spec=html>ancestor browsing context</span>'s
 <span data-anolis-spec=dom title=concept-document>documents</span> (if any)
 and <var title>doc</var>.

 <li>
  <p>For each <var title>document</var> in <var title>docs</var>, run these
  substeps:

  <ol>
   <li><p>Let <var title>following document</var> be the
   <span data-anolis-spec=dom title=concept-document>document</span> after
   <var title>document</var> in <var title>docs</var>, or null if there is
   no such document.

   <li><p>If <var title>following document</var> is null,
   <span title=concept-fullscreen-push>push</span>
   <span>context object</span> on
   <var title>document</var>'s <span>fullscreen element stack</span>, and
   <span data-anolis-spec=html>queue a task</span> to
   <span data-anolis-spec=dom title=concept-event-fire>fire an event</span>
   named <code>fullscreenchange</code> with its
   <code title=dom-Event-bubbles>bubbles</code> attribute set to true on the
   <var title>document</var>.

   <li><p>Otherwise, if <var title>document</var>'s
   <span>fullscreen element stack</span> is either empty or its top
   <span data-anolis-spec=dom title=concept-element>element</span> is not
   <var title>following document</var>'s
   <span data-anolis-spec=html>browsing context container</span>,
   <span title-concept-fullscreen-push>push</span>
   <var title>following document</var>'s
   <span data-anolis-spec=html>browsing context container</span> on
   <var title>document</var>'s <span>fullscreen element stack</span>, and
   <span data-anolis-spec=html>queue a task</span> to
   <span data-anolis-spec=dom title=concept-event-fire>fire an event</span>
   named <code>fullscreenchange</code> with its
   <code title=dom-Event-bubbles>bubbles</code> attribute set to true on
   <var title>document</var>.

   <li><p>Otherwise, do nothing for this <var title>document</var>. It stays
   the same.
  </ol>

 <li><p>Return, and run the remaining steps asynchronously.

 <li><p>Optionally, perform some animation.

 <li><p>Optionally, display a message indicating how the user can exit
 displaying the <span>context object</span> fullscreen.
</ol>

<p>The
<dfn title=dom-Document-fullscreenEnabled><code>fullscreenEnabled</code></dfn>
attribute must return true if the <span>context object</span> and all
<span data-anolis-spec=html>ancestor browsing context</span>'s
<span data-anolis-spec=dom title=concept-document>documents</span> have
their <span>fullscreen enabled flag</span> set, or false otherwise.

<p>The <dfn title=dom-Document-fullscreenElement><code>fullscreenElement</code></dfn>
attribute must return the top
<span data-anolis-spec=dom title=concept-element>element</span> of the
<span>context object</span>'s
<span>fullscreen element stack</span>, or null otherwise.

<p>The
<dfn title=dom-Document-exitFullscreen><code>exitFullscreen()</code></dfn>
method must run these steps:

<ol>
 <li><p>Let <var title>doc</var> be the <span>context object</span>.

 <li><p>If <var title>doc</var>'s <span>fullscreen element stack</span> is
 empty, terminate these steps.

 <li><p>Let <var title>descendants</var> be all the <var title>doc</var>'s
 <span data-anolis-spec=html>descendant browsing context</span>'s
 <span data-anolis-spec=dom title=concept-document>documents</span> with a
 non-empty <span>fullscreen element stack</span> (if any), ordered so that
 the child of the <var title>doc</var> is last and the
 <span data-anolis-spec=dom title=concept-document>document</span> furthest
 away from the <var title>doc</var> is first.
 <!-- XXX order terminology -->

 <li><p>For each <var title>descendant</var> in
 <var title>descendants</var>,
 <span title=concept-fullscreen-empty>empty</span>
 <var title>descendant</var>'s <span>fullscreen element stack</span>, and
 <span data-anolis-spec=html>queue a task</span> to
 <span data-anolis-spec=dom title=concept-event-fire>fire an event</span>
 named <code>fullscreenchange</code> with its
 <code title=dom-Event-bubbles>bubbles</code> attribute set to true on
 <var title>descendant</var>.

 <li>
  <p>While <var title>doc</var> is not null, run these substeps:

  <ol>
   <li>
    <p><span title=concept-fullscreen-remove>Remove</span> the top
    <span data-anolis-spec=dom title=concept-element>element</span> of
    <var title>doc</var>'s <span>fullscreen element stack</span>.

    <p>If <var title>doc</var>'s <span>fullscreen element stack</span> is
    non-empty and the
    <span data-anolis-spec=dom title=concept-element>element</span> now at
    the top is either not <span data-anolis-spec=dom>in a document</span> or
    its
    <span data-anolis-spec=dom title=concept-node-document>node document</span>
    is not <var title>doc</var>, repeat this substep.

    <p class=note>This is needed because a non-top
    <span data-anolis-spec=dom title=concept-element>element</span> in the
    <span>fullscreen element stack</span> could have been removed from
    <var title>doc</var>.

   <li><p><span data-anolis-spec=html>Queue a task</span> to
   <span data-anolis-spec=dom title=concept-event-fire>fire an event</span>
   named <code>fullscreenchange</code> with its
   <code title=dom-Event-bubbles>bubbles</code> attribute set to true on
   <var title>doc</var>.

   <li><p>If <var title>doc</var>'s <span>fullscreen element stack</span> is
   empty and <var title>doc</var>'s
   <span data-anolis-spec=html>browsing context</span> has a
   <span data-anolis-spec=html>browsing context container</span>, set
   <var title>doc</var> to that
   <span data-anolis-spec=html>browsing context container</span>'s
   <span data-anolis-spec=dom title=concept-node-document>node document</span>.

   <li><p>Otherwise, set <var title>doc</var> to null.
  </ol>

 <li><p>Return, and run the remaining steps asynchronously.

 <li><p>Optionally, perform some animation.
</ol>



<h2>UI</h2>

<p>User agents are encouraged to implement native media fullscreen controls
in terms of
<code title=dom-Element-requestFullscreen>requestFullscreen()</code> and
<code title=dom-Document-exitFullscreen>exitFullscreen()</code>.

<p>If the end user instructs the user agent to end a fullscreen session
initiated via
<code title=dom-Element-requestFullscreen>requestFullscreen()</code>,
<span>fully exit fullscreen</span>.



<h2>Rendering</h2>

<p>This section is to be interpreted equivalently to the Rendering section
of HTML. <span data-anolis-ref>HTML</span>


<h3>New stacking layer</h3>

<!-- CSS is clunky as hell. That's why we patch it until we die. Ideally
though someone smart comes along and writes a better CSS standard. -->

<p>This standard introduces a new stacking layer to the
<a href=http://www.w3.org/TR/CSS21/zindex.html>Elaborate description of Stacking Contexts</a>
of CSS 2.1. It is called the <dfn>top layer</dfn>, comes after layer 10, and
is therefore rendered closest to the user within a viewport. Each
<span data-anolis-spec=html>browsing context</span> has one associated
viewport and therefore also one <span>top layer</span>.

<!-- XXX brackets ref? -->

<p class=note>The terminology used in this and following subsection attempts
to match CSS 2.1 Appendix E.

<p>The <span>top layer</span> consists of a stack of elements, rendered in
the order they have been added to the stack. The last element added to the
stack is rendered closest to the user.

<p class=note>The <code title>z-index</code> property has no effect in the
<span>top layer</span>.

<p>An element in this stack has the following attributes:

<ul>
 <li><p>It generates a new stacking context.

 <li><p>Its containing block is the initial containing block.

 <li>
  <p>Its rendered as an atomic unit as it were a sibling of the root
  element.

  <p class=note>Ancestor elements with overflow, opacity, masks, etc. cannot
  affect it.

 <li><p>Its not rendered if it, or an ancestor, has its
 <code title>display</code> property set to <code title>none</code>.

 <li><p>Its <code title>position</code> property computes to
 <code title>absolute</code>, <code title>center</code>, or
 <code title>fixed</code>, if one of those is the specified value, or
 <code title>absolute</code> otherwise.

 <li><p>Its outline, if any, is to be rendered before layer 10.

 <li><p>Unless overridden by another specification, its static position for
 <code title>left</code>, <code title>right</code>, and
 <code title>top</code> is zero.
</ul>


<h3><code title>::backdrop</code> pseudo-element</h3>

<p>Each element in the <span>top layer</span>'s stack has a
<dfn title=css-pe-backdrop><code>::backdrop</code></dfn> pseudo-element.
This pseudo-element is a box rendered immediately below the element (and
above the element below the element in the stack, if any), within the same
<span>top layer</span>.


<h3><code title>:fullscreen</code> pseudo-class</h3>

<p>The <dfn title=css-pc-fullscreen><code>:fullscreen</code></dfn>
pseudo-class must match the top
<span data-anolis-spec=dom title=concept-element>element</span> of the
<span>context object</span>'s
<span>fullscreen element stack</span> (if any).


<h3>User-agent level style sheet defaults</h3>
<!-- HTML's "The CSS user agent style sheet and presentational hints"
section uses this term -->

<pre class=css>:fullscreen {
  position:fixed;
  top:0; right:0; bottom:0; left:0;
  margin:0;
  box-sizing:border-box;
  width:100%;
  height:100%;
}

iframe:fullscreen {
  border:none;
}

:fullscreen::backdrop {
  position:fixed;
  top:0; right:0; bottom:0; left:0;
  background:black;
}</pre>



<h2>Security and Privacy Considerations</h2>

<p>User agents should ensure, e.g. by means of an overlay, that the end user
is aware something is displayed fullscreen. User agents should provide a
means of exiting fullscreen that always works and advertise this to the
user. This is to prevent a site from spoofing the end user by recreating the
user agent or even operating system environment when fullscreen. See also
the definition of
<code title=dom-Element-requestFullscreen>requestFullscreen()</code>.

<p>To prevent embedded content from going fullscreen only embedded content
specifically allowed via the <code>allowfullscreen</code> attribute of the
HTML <code>iframe</code> element will be able to go fullscreen. This
prevents untrusted content from going fullscreen.



<h2 class=no-num>References</h2>
<div id=anolis-references></div>



<h2 class=no-num>Acknowledgments</h2>

<p>Many thanks to Robert O'Callahan for designing the initial model and
being awesome.
<!-- https://wiki.mozilla.org/Gecko:FullScreenAPI -->

<p>Thanks to
Chris Pearce,
Darin Fisher,
Edward O'Connor,
Glenn Maynard,
Ian Hickson,
João Eiras,
Josh Soref,
Rafał Chłodnicki,
Rune Lillesveen,
Sigbj&oslash;rn Vik, and
Tab Atkins

for also being awesome.


<script id=head src=http://www.whatwg.org/specs/web-apps/current-work/dfn.js class=dontpublish></script>
